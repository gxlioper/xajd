/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package xgxt.xljk.mjxy.xlkh;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;

import xgxt.action.BaseAction;
import xgxt.utils.FormModleCommon;
import xgxt.utils.GetTime;

/** 
 * MyEclipse Struts
 * Creation date: 12-07-2010
 * 
 * XDoclet definition:
 * @struts.action validate="true"
 */
public class XljkMjxyKhxsftAction extends BaseAction {
	/*
	 * Generated Methods
	 */

	/** 
	 * Method khxsftJl
	 * 心理困惑学生访谈记录
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 */
	public ActionForward khxsftJl(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		
		XljkMjxyKhxsftForm myForm=(XljkMjxyKhxsftForm)form;
		
		String doType=request.getParameter("doType");
		String tabName="xljk_mjxy_khxsftb";
		
		if("save".equalsIgnoreCase(doType)){
			
			this.insertOperation(request, tabName);
			String pkValue=myForm.getSave_bh();
			this.selectPageDataByOne(request, tabName, tabName, pkValue);
			request.setAttribute("pkValue", pkValue);
		}
		request.setAttribute("doType", doType);
		request.setAttribute("nowTime", GetTime.getNowTime2());
		request.setAttribute("path", "xljkMjxyKhxsft.do?method=khxsftJl&doType=add");
		FormModleCommon.commonRequestSet(request);
		return mapping.findForward("khxsftJl");
	}
	
	/** 
	 * Method khxsftJl
	 * 心理困惑学生访谈查询
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 */
	public ActionForward khxsftCx(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		
		XljkMjxyKhxsftForm myForm=(XljkMjxyKhxsftForm)form;
		
		String doType=request.getParameter("doType");
		String tabName="xljk_mjxy_khxsftb";
		
		if("del".equalsIgnoreCase(doType)){
			this.deleteOperation(request, tabName);
			doType="qry";
		}
				
		if("qry".equalsIgnoreCase(doType)){
			StringBuilder qry=new StringBuilder();
			if(!"".equalsIgnoreCase(myForm.getKssj())){
				qry.append(" and txsj >= "+myForm.getKssj());
			}
			if(!"".equalsIgnoreCase(myForm.getJssj())){
				qry.append(" and txsj <= "+myForm.getJssj());
			}
			request.setAttribute("annexTerm", qry);
			String[]outputColumn={"pkValue","bh","ftls","ftsj","txsj"};
			this.selectPageDataByPagination(request, myForm, tabName, tabName, outputColumn);
			
		}
		
		request.setAttribute("path", "xljkMjxyKhxsft.do?method=khxsftCx");
		FormModleCommon.commonRequestSet(request);
		return mapping.findForward("khxsftCx");
	}
	
	/** 
	 * Method khxsftJl
	 * 心理困惑学生单条记录
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 */
	public ActionForward khxsftOne(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		// TODO Auto-generated method stub
		String pkValue=request.getParameter("pkValue");
		String doType=request.getParameter("doType");
		String tabName="xljk_mjxy_khxsftb";
		if("update".equalsIgnoreCase(doType)){
			this.updateOperation(request, tabName);
		}
				
		if(!"".equalsIgnoreCase(doType)){
			this.selectPageDataByOne(request, tabName, tabName, pkValue);
			
		}
		request.setAttribute("pkValue", pkValue);
		request.setAttribute("path", "xljkMjxyKhxsft.do?method=khxsftJl&doType=add");
		FormModleCommon.commonRequestSet(request);
		request.setAttribute("doType", doType);
		return mapping.findForward("khxsftJl");
	}
	
	/**
	 * 心理困惑学生访谈记录
	 * 
	 */
	public ActionForward khxsftjlb(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		// TODO Auto-generated method stub
		String pkValue=request.getParameter("pkValue");
		
		String tabName="xljk_mjxy_khxsftb";
		this.selectPageDataByOne(request, tabName, tabName, pkValue);
	
		return mapping.findForward("khxsftjlb");
	}
	
	/**
	 * 辅导员跟踪访谈记录
	 * 
	 */
	public ActionForward fdygzftb(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		// TODO Auto-generated method stub
		String pkValue=request.getParameter("pkValue");
		
		String tabName="xljk_mjxy_khxsftb";
		this.selectPageDataByOne(request, tabName, tabName, pkValue);
	
		return mapping.findForward("fdygzftb");
	}
	
	/**
	 * 信息导出
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 * */
	public ActionForward expDate(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		
		String tabName="xljk_mjxy_khxsftb";
		try {
			this.expPageData(request, response, tabName, tabName, null);
		} catch (Exception e) {
			e.printStackTrace();
		}			
		return mapping.findForward("success");
	}
}