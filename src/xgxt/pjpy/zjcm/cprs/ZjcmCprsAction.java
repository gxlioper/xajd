/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package xgxt.pjpy.zjcm.cprs;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;

import xgxt.action.BaseAction;
import xgxt.utils.FormModleCommon;

/** 
 * MyEclipse Struts
 * Creation date: 08-30-2010
 * 浙江传媒参评人数设置
 * XDoclet definition:
 * @struts.action validate="true"
 */
public class ZjcmCprsAction extends BaseAction {
	/*
	 * Generated Methods
	 */

	/** 
	 * Method cprsWh
	 * 参评人数设
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 * @throws Exception 
	 */
	public ActionForward cprsWh(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) throws Exception {
		
		HttpSession session =request.getSession();
		ZjcmCprsService service=new ZjcmCprsService();
		ZjcmCprsForm zjcmCprsForm=(ZjcmCprsForm)form;
		
		String viewName="view_zjcm_pjpy_cprssz";
		String tableName="zjcm_pjpy_cprssz";
		String doType=request.getParameter("doType");	
		
		String userType=session.getAttribute("userType").toString();
		String userDep=session.getAttribute("userDep").toString();
		 
		if("save".equalsIgnoreCase(doType)){
			service.cprsWh(request, zjcmCprsForm);
			doType="qry";
		}
		if("qry".equalsIgnoreCase(doType)){
			String []outputColumn={"bjdm","nj","xymc","zymc","bjmc","rs"};
			this.selectPageDataByPagination(request, form, tableName, viewName, outputColumn);
		}
		
		if("xy".equalsIgnoreCase(userType)){
			zjcmCprsForm.setXydm(userDep);
		}
		
		request.setAttribute("path", "zjcmCprs.do?method=cprsWh");
		FormModleCommon.setNjXyZyBjListForFdyBzr(request);
		FormModleCommon.setNdXnXqList(request);
		FormModleCommon.commonRequestSet(request);
		return mapping.findForward("cprsWh");
	}
	
	/**
	 * 参评人数信息倒出
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 * */
	public ActionForward expDate(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) {
		
		try {
			
			this.expPageData(request, response, "zjcm_pjpy_cprssz", "view_zjcm_pjpy_cprssz", null);
		
		} catch (Exception e) {
		
			e.printStackTrace();
		
		}			
		
		return mapping.findForward("success");
	}
}