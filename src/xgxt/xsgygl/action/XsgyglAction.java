/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package xgxt.xsgygl.action;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.apache.struts.action.Action;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;

import common.Globals;

import xgxt.action.Base;
import xgxt.daoActionLogic.StandardOperation;
import xgxt.form.CommanForm;

/** 
 * MyEclipse Struts
 * Creation date: 06-21-2007
 * 
 * XDoclet definition:
 * @struts.action validate="true"
 */
public class XsgyglAction extends Action {
	String writeAble = "";
	public ActionForward execute(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) throws Exception {
		// TODO Auto-generated method stub
		HttpSession session = request.getSession();
		String userType = session.getAttribute("userType").toString(); //直接获得用户类型，此方式获取的类型为两类：1、"stu"学生2、"teacher"教师
		try {
			String xxdm = StandardOperation.getXxdm();
			//判断用户读写权
			writeAble = Base.getWriteAble(request);
			String dxq = request.getParameter("writeAble");
			if(!"".equalsIgnoreCase(dxq) && dxq != null){
				writeAble = dxq;
			}
			/** 在线检测 */
			int i = Base.chkTimeOut(session);
			if (i <= 2) {
				request.setAttribute("errMsg", "登陆超时，请重新登陆！");
				return new ActionForward("/login.jsp", false);
			}
			String myAction = mapping.getParameter();
			ActionForward myActFwd = null;
			if ("init_page_info".equalsIgnoreCase(myAction)){ //初始化主查询页面
				myActFwd = XsgyglOperationAction.initMainPageInfo(mapping, form, request, response);
			} else if("del_stu_dromDistribut".equalsIgnoreCase(myAction)){ //删除学生住宿情况
				myActFwd = XsgyglOperationAction.delDromDistribut(mapping, form, request, response);
			} else if ("active_plan_manage".equalsIgnoreCase(myAction)){ //制定活动计划
				myActFwd = XsgyglOperationAction.putActivePlan(mapping, form, request, response);
			} else if ("saveHdjh".equalsIgnoreCase(myAction)){  //保存活动计划
				myActFwd = XsgyglOperationAction.SaveHdjh(mapping, form, request, response);
			} else if ("hd_Content".equalsIgnoreCase(myAction)){ //查看活动计划内容
				myActFwd = XsgyglOperationAction.showPlanContent(mapping, form, request, response);
			} else if ("show_active_plan".equalsIgnoreCase(myAction)){ //显示活动计划列表
				myActFwd = XsgyglOperationAction.showActivePlanList(mapping, form, request, response);
			} else if ("stu_dromInfo".equalsIgnoreCase(myAction)){ //增加学生住宿信息
				myActFwd = XsgyglOperationAction.whDromInfo(mapping, form, request, response);
			} else if ("drom_DataModi".equalsIgnoreCase(myAction)){ //保存学生住宿信息
				myActFwd = XsgyglOperationAction.stuDromDataModi(mapping, form, request, response);
			} else if ("stu_active_InfoManage".equalsIgnoreCase(myAction)){ //学生活动信息管理
				myActFwd = XsgyglOperationAction.stuActiveInfoManage(mapping, form, request, response);
			} else if ("del_stu_ActiveInfo".equalsIgnoreCase(myAction)){  //删除学生活动信息
				myActFwd = XsgyglOperationAction.delStuActiveInfo(mapping, form, request, response);
			} else if ("stu_ActiveInfo".equalsIgnoreCase(myAction)){ //增加学生活动信息
				myActFwd = XsgyglOperationAction.whStuActiveInfo(mapping, form, request, response);
			} else if ("stuActive_DataModi".equalsIgnoreCase(myAction)){  //保存学生活动信息
				myActFwd = XsgyglOperationAction.stuActiveDataModi(mapping, form, request, response);
			} else if ("stu_active_thing".equalsIgnoreCase(myAction)){ //学生活动记录
				myActFwd = XsgyglOperationAction.stuActiveInfoManage(mapping, form, request, response);
			} else if ("dromfloorFugDis".equalsIgnoreCase(myAction)){ //楼层长分布
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}
				myActFwd = XsgyglOperationAction.dromFloorFugDis(mapping, form, request, response);
			} else if ("addDromFugle".equalsIgnoreCase(myAction)){ //添加楼层长信息
				myActFwd = XsgyglOperationAction.addDromFugle(mapping, form, request, response);
			} else if ("SaveLczxx".equalsIgnoreCase(myAction)){ //保存楼层长信息
				myActFwd = XsgyglOperationAction.SaveLczxx(mapping, form, request, response);
			} else if ("Ry_manager".equalsIgnoreCase(myAction)){ //学生活动评优申请
				myActFwd = XsgyglOperationAction.StuActiveActorApply(mapping, form, request, response);
			} else if ("dataSave".equalsIgnoreCase(myAction)){ //保存数据
				myActFwd = XsgyglOperationAction.dataSave(mapping, form, request, response);
			} else if ("perfor_check".equalsIgnoreCase(myAction)){ //绩效考核
				myActFwd = XsgyglOperationAction.stuActivePerforCheck(mapping, form, request, response);
			} else if ("CheckSave".equalsIgnoreCase(myAction)){ //保存绩效考核
				myActFwd = XsgyglOperationAction.stuActivePerforCheckSave(mapping, form, request, response);
			} else if ("lcz_info".equalsIgnoreCase(myAction)){ //上海工程楼层长基本信息维护
				myActFwd = XsgyglOperationAction.floorFugBasicInfo(mapping, form, request, response);
			} else if ("lczxxSave".equalsIgnoreCase(myAction)){ //保存楼层长基本信息维护
				myActFwd = XsgyglOperationAction.floorFugBasicInfoSave(mapping, form, request, response);
			} else if ("del_All_data".equalsIgnoreCase(myAction)){ //全部删除功能
				myActFwd = StandardOperation.delAllData(mapping, form, request, response);
			} else if ("holidayPutUpInfo".equalsIgnoreCase(myAction)){ //假期留校信息
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					if(!Globals.XXDM_YNYS.equalsIgnoreCase(xxdm)){//非云南艺术
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
					}
				}
				myActFwd = XsgyglOperationAction.holidayPutUpInfo(mapping, form, request, response);
			} else if ("holidayLsxx".equalsIgnoreCase(myAction)){ //假期留校增删改
				myActFwd = XsgyglOperationAction.MainHolidayLsxx(mapping, form, request, response);
			} else if ("holidayLsxxSave".equalsIgnoreCase(myAction)){ //假期留校信息保存
				myActFwd = XsgyglOperationAction.SaveHolidayLsxx(mapping, form, request, response);
			} else if ("emptydormManager".equalsIgnoreCase(myAction)){ //空闲宿舍管理
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}
				myActFwd = XsgyglOperationAction.ManagerEmptyDormInfo(mapping, form, request, response);
			} else if ("outPutstuManager".equalsIgnoreCase(myAction)){ //外住学生管理
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}
				myActFwd = XsgyglOperationAction.ManagerOutPutStuInfo(mapping, form, request, response);
			} else if ("stuOutputInfo".equalsIgnoreCase(myAction)){ //添加学生外住信息
				myActFwd = XsgyglOperationAction.WhStuOutPutInfo(mapping, form, request, response);
			} else if ("OutputstuinfoSave".equalsIgnoreCase(myAction)){ //保存学生外住信息
				myActFwd = XsgyglOperationAction.SaveOutPutStuInfo(mapping, form, request, response);
			} else if("stu_gydykp_info".equalsIgnoreCase(myAction)){ //查看学生公寓德育考评				
				myActFwd = XsgyglOperationAction.StuGydykpInfo(mapping, form, request, response);
			} else if("gygl_gzcj_zsjl".equalsIgnoreCase(myAction)){ //广州城建晚归登记表
				myActFwd = XsgyglOperationAction.StuWgRollCall(mapping, form, request, response);
			} else if("zsjlSave".equalsIgnoreCase(myAction)){ //广州城建晚归登记保存
				myActFwd = XsgyglOperationAction.SaveZsjlxx(mapping, form, request, response);
			} else if ("dormDistribute".equalsIgnoreCase(myAction)) { //宿舍划分
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}if("xy".equalsIgnoreCase(userType)){
					CommanForm myForm = (CommanForm)form;
					myForm.setXydm((String)request.getSession().getAttribute("userDep"));
					
					// ==================登陆用户检测 ==================
					String msg = "本模块只能由学校（管理员）用户进行操作，请确认！";
					request.setAttribute("yhInfo", msg);
					return new ActionForward("/yhInfo.do", false);
					// =================end ===================
				}
				myActFwd = XsgyglOperationAction.dormDistribute(mapping, form, request, response);
			} else if ("bedDistribute".equalsIgnoreCase(myAction)) { //床位分配
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}  
				myActFwd = XsgyglOperationAction.bedDistribute(mapping, form, request, response);
			} else if ("dormRepair".equalsIgnoreCase(myAction)) { //公寓维修
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}  
				myActFwd = XsgyglOperationAction.dormRepair(mapping, form, request, response);
			} else if ("sanitationCheck".equalsIgnoreCase(myAction)) { //卫生检查
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}
				// -------------begin luojw 2010/3/23 ----------------------
				if (!Globals.XXDM_HHGXY.equalsIgnoreCase(xxdm)// （淮海工学院）
						&&!Globals.XXDM_ZJLG.equalsIgnoreCase(xxdm)// （浙江理工大学）
						&&!Globals.XXDM_CZXXZYJSXY.equalsIgnoreCase(xxdm)// （常州信息职业技术学院）
						&&!Globals.XXDM_HZZY.equalsIgnoreCase(xxdm)// （杭州职业技术学院）
							&&!Globals.XXDM_HENANGYDX.equalsIgnoreCase(xxdm)//（河南工业大学）
							&&!Globals.XXDM_HNDX.equalsIgnoreCase(xxdm)//（河南大学）
							&&!Globals.XXDM_JSXX.equalsIgnoreCase(xxdm)//（江苏信息职业技术学院）
							&&!Globals.XXDM_CSDLZYJSXY.equalsIgnoreCase(xxdm)//（长沙电力职业技术学院）
							&&!Globals.XXDM_ZGKYDX.equalsIgnoreCase(xxdm)//（中国矿业大学）
								&&!Globals.XXDM_SHGC.equalsIgnoreCase(xxdm)//（上海工程技术大学）
						) {
					return new ActionForward("/zjcm_gygl_wsjc.do", false);
				}
				// -------------end luojw 2010/3/23 -------------------------
				myActFwd = XsgyglOperationAction.sanitationCheck(mapping, form, request, response);
			} else if ("dormDiscipline".equalsIgnoreCase(myAction)) { //住宿纪律
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}
				myActFwd = XsgyglOperationAction.dormDiscipline(mapping, form, request, response);
			} else if ("dormDifferent".equalsIgnoreCase(myAction)) { //宿舍异动
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}
				myActFwd = XsgyglOperationAction.dormDifferent(mapping, form, request, response);
			}  else if ("gdnz_xqxsrstj".equalsIgnoreCase(myAction)) { //SQ 学期学生人数统计
				myActFwd = XsgyglOperationAction.GdnzXqStuRsTj(mapping, form, request, response);
			} else if ("gdnz_ndzxxstj".equalsIgnoreCase(myAction)){ //SQ 年度在校学生统计
				myActFwd = XsgyglOperationAction.GdnzNdZxStuTj(mapping, form, request, response);
			} else if ("gdnz_dormSlt".equalsIgnoreCase(myAction)){ //SQ 缩略图
				myActFwd = XsgyglOperationAction.GdnzDormFbSlt(mapping, form, request, response);
			} else if ("gdnz_dormFpb".equalsIgnoreCase(myAction)){ //SQ 生成宿舍分配表
				myActFwd = XsgyglOperationAction.GdnzDormFpb(mapping, form, request, response);
			} else if ("lzxx_manage".equalsIgnoreCase(myAction)){//lp 杭州职业楼长信息管理
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}
				myActFwd = XsgyglOperationAction.lzxx_manage(mapping,form,request,response);
			} else if("lzxx_add".equalsIgnoreCase(myAction)){//
				myActFwd = XsgyglOperationAction.lzxx_add(mapping,form,request,response);
			} else if("wmqspb_result".equalsIgnoreCase(myAction)){
				myActFwd = XsgyglOperationAction.wmqspb_result(mapping,form,request,response);
			} else if("stu_LdQsInfo".equalsIgnoreCase(myAction)){//学生对应楼栋、寝室信息查询
				myActFwd = XsgyglOperationAction.stu_LdQsInfo(mapping,form,request,response);
			} else if(("gygl_ParaSet").equalsIgnoreCase(myAction)){
				if(userType.equalsIgnoreCase("stu")){//学生无操作权限
					request.setAttribute("errMsg", "学生无权访问该页面！");
				    return new ActionForward("/errMsg.do", false);
				}
				myActFwd = XsgyglOperationAction.gygl_ParaSet(mapping,form,request,response);
			} else if(("acws_DormDis").equalsIgnoreCase(myAction)){//按床位数分配（公用版本）
				myActFwd = XsgyglOperationAction.acws_DormDis(mapping,form,request,response);
			}else if(("wsjctj").equalsIgnoreCase(myAction)){
				myActFwd = XsgyglOperationAction.wsjctj(mapping,form,request,response);
			}
			if(!Base.isNull(XsgyglOperationAction.writeAble)){
				writeAble = XsgyglOperationAction.writeAble;
			}
			request.setAttribute("writeAble", writeAble);
			return myActFwd;
		} catch (Exception e) {
			e.printStackTrace();
			request.setAttribute("errMsg", "系统出现故障，请与管理员取得联系！" + e.toString());
			return new ActionForward("/errMsg.do", false);
		}
	}
}